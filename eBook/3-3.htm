<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./3-3.files/filelist.xml">
<link rel=Edit-Time-Data href="./3-3.files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>实验3 进程描述与控制</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Zhou Su</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>mummer</o:LastAuthor>
  <o:Revision>11</o:Revision>
  <o:TotalTime>19</o:TotalTime>
  <o:LastPrinted>2003-05-27T04:21:00Z</o:LastPrinted>
  <o:Created>2003-07-13T22:23:00Z</o:Created>
  <o:LastSaved>2003-07-20T12:08:00Z</o:LastSaved>
  <o:Pages>11</o:Pages>
  <o:Words>2272</o:Words>
  <o:Characters>12954</o:Characters>
  <o:Company>Zx co.</o:Company>
  <o:Lines>107</o:Lines>
  <o:Paragraphs>25</o:Paragraphs>
  <o:CharactersWithSpaces>15908</o:CharactersWithSpaces>
  <o:Version>9.2812</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>110</w:Zoom>
  <w:HideSpellingErrors/>
  <w:PunctuationKerning/>
  <w:DrawingGridHorizontalSpacing>0.1 磅</w:DrawingGridHorizontalSpacing>
  <w:DrawingGridVerticalSpacing>0.1 磅</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:黑体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimHei;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@黑体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:楷体_utf-8;
	panose-1:2 1 6 9 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:"\@楷体_utf-8";
	panose-1:2 1 6 9 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:1 135135232 16 0 262144 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
h1
	{mso-style-next:正文;
	margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:0cm;
	text-align:center;
	line-height:240%;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:15.0pt;
	mso-bidi-font-size:22.0pt;
	font-family:黑体;
	mso-hansi-font-family:宋体;
	mso-font-kerning:22.0pt;}
h2
	{mso-style-next:正文;
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	text-align:center;
	line-height:170%;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:12.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:黑体;
	mso-hansi-font-family:Arial;
	mso-font-kerning:1.0pt;}
h3
	{mso-style-next:正文;
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:170%;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:10.5pt;
	mso-bidi-font-size:16.0pt;
	font-family:黑体;
	mso-hansi-font-family:宋体;
	mso-font-kerning:1.0pt;}
h4
	{mso-style-next:正文;
	margin-top:14.0pt;
	margin-right:0cm;
	margin-bottom:14.5pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:155%;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:10.5pt;
	mso-bidi-font-size:14.0pt;
	font-family:宋体;
	mso-font-kerning:1.0pt;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	text-transform:uppercase;
	mso-font-kerning:1.0pt;
	font-weight:bold;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:10.5pt;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	font-variant:small-caps;
	mso-font-kerning:1.0pt;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.0pt;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;
	font-style:italic;}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:31.5pt;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:10.5pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.0pt;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:10.5pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:52.5pt;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:10.5pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:63.0pt;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:10.5pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:73.5pt;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:10.5pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{mso-style-update:auto;
	mso-style-next:正文;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:84.0pt;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:10.5pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:none;
	tab-stops:center 207.65pt right 415.3pt;
	layout-grid-mode:char;
	border:none;
	mso-border-bottom-alt:solid windowtext .75pt;
	padding:0cm;
	mso-padding-alt:0cm 0cm 1.0pt 0cm;
	font-size:9.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:none;
	tab-stops:center 207.65pt right 415.3pt;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	background:navy;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	font-family:宋体;
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	mso-font-kerning:1.0pt;}
p.a, li.a, div.a
	{mso-style-name:图表标题;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:none;
	font-size:9.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:黑体;
	mso-hansi-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:1.0pt;}
 /* Page Definitions */
@page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;
	mso-facing-pages:yes;}
@page Section1
	{size:515.95pt 728.6pt;
	margin:92.15pt 2.0cm 92.15pt 76.55pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-page-numbers:46;
	mso-title-page:yes;
	mso-even-header:url("./3-3.files/header.htm") eh1;
	mso-header:url("./3-3.files/header.htm") h1;
	mso-first-header:url("./3-3.files/header.htm") fh1;
	mso-paper-source:0;
	layout-grid:15.6pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:1212183210;
	mso-list-type:hybrid;
	mso-list-template-ids:1256876452 67698699 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0D8;
	mso-level-tab-stop:21.0pt;
	mso-level-number-position:left;
	margin-left:21.0pt;
	text-indent:-21.0pt;
	font-family:Wingdings;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1613">
  <o:colormenu v:ext="edit" fillcolor="none" strokecolor="none"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
  <o:regrouptable v:ext="edit">
   <o:entry new="1" old="0"/>
   <o:entry new="2" old="0"/>
   <o:entry new="3" old="0"/>
   <o:entry new="4" old="0"/>
   <o:entry new="5" old="0"/>
   <o:entry new="6" old="0"/>
   <o:entry new="7" old="0"/>
   <o:entry new="8" old="0"/>
   <o:entry new="9" old="0"/>
   <o:entry new="10" old="0"/>
   <o:entry new="11" old="10"/>
   <o:entry new="12" old="11"/>
   <o:entry new="13" old="12"/>
   <o:entry new="14" old="12"/>
   <o:entry new="15" old="12"/>
   <o:entry new="16" old="0"/>
   <o:entry new="17" old="0"/>
   <o:entry new="18" old="17"/>
   <o:entry new="19" old="18"/>
   <o:entry new="20" old="19"/>
   <o:entry new="21" old="20"/>
   <o:entry new="22" old="21"/>
   <o:entry new="23" old="22"/>
   <o:entry new="24" old="23"/>
   <o:entry new="25" old="24"/>
   <o:entry new="26" old="0"/>
  </o:regrouptable>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=ZH-CN link=blue vlink=purple style='tab-interval:21.0pt;text-justify-trim:
punctuation'>

<div class=Section1 style='layout-grid:15.6pt'>

<p class=MsoNormal align=right style='text-align:right'><a name="_top"></a><b><span
style='font-size:26.0pt;mso-bidi-font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:#993366'>实验</span></b><b><i
style='mso-bidi-font-style:normal'><span lang=EN-US style='font-size:55.0pt;
mso-bidi-font-size:12.0pt;color:#993366'>3</span></i><span lang=EN-US
style='color:#993366'><o:p></o:p></span></b></p>

<p class=MsoNormal align=right style='text-align:right;word-break:break-all'><!--[if gte vml 1]><v:shapetype
 id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
 path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_s1609" type="#_x0000_t75" style='position:absolute;
 left:0;text-align:left;margin-left:0;margin-top:0;width:546.85pt;height:34.15pt;
 z-index:-1;mso-wrap-edited:f;mso-position-horizontal:left;
 mso-position-vertical:top;mso-position-vertical-relative:line' wrapcoords="-26 0 -26 21176 21600 21176 21600 0 -26 0"
 o:allowoverlap="f">
 <v:imagedata src="./3-3.files/image001.jpg" o:title="image_bk"/>
 <w:wrap type="square" anchorx="page"/>
</v:shape><![endif]--><![if !vml]><img width=729 height=46
src="./3-3.files/image002.jpg" align=left hspace=12 v:shapes="_x0000_s1609"><![endif]><b><span
style='font-size:24.0pt;mso-bidi-font-size:12.0pt;font-family:黑体;mso-ascii-font-family:
"Times New Roman";color:navy'>进程控制与描述</span></b><b><span lang=EN-US
style='font-size:16.0pt;mso-bidi-font-size:12.0pt;mso-fareast-font-family:黑体;
color:navy'><span style="mso-spacerun: yes">&nbsp; </span></span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><a name="_Toc45702461"></a><a name="_Toc39769784"></a><a name="_Toc16587483"><span
style='mso-bookmark:_Toc39769784'><span style='mso-bookmark:_Toc45702461'><span
lang=EN-US style='mso-bidi-font-family:宋体'>3.3<span style="mso-spacerun:
yes">&nbsp; </span>Windows 2000进程的</span></span></span></a><span
style='mso-bookmark:_Toc16587483'><span style='mso-bookmark:_Toc39769784'><span
style='mso-bookmark:_Toc45702461'><span lang=EN-US style='font-family:Arial;
mso-ascii-font-family:黑体;mso-bidi-font-family:"Times New Roman"'>“</span></span></span></span><span
style='mso-bookmark:_Toc16587483'><span style='mso-bookmark:_Toc39769784'><span
style='mso-bookmark:_Toc45702461'><span style='mso-bidi-font-family:宋体'>一生</span></span></span></span><span
style='mso-bookmark:_Toc16587483'><span style='mso-bookmark:_Toc39769784'><span
style='mso-bookmark:_Toc45702461'><span lang=EN-US style='font-family:Arial;
mso-ascii-font-family:黑体;mso-bidi-font-family:"Times New Roman"'>”</span></span></span></span><span
style='mso-bookmark:_Toc45702461'></span><span style='mso-bookmark:_Toc39769784'></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='mso-bidi-font-family:
宋体'><o:p></o:p></span></span></h2>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US>(</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>实验估计时间：</span><span
lang=EN-US>120</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分钟</span><span lang=EN-US>)</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>&nbsp;</span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 21.0pt'><span style='mso-bookmark:_Toc16587483'><![if !supportLists]><span
lang=EN-US style='font-family:Wingdings'>&Oslash;<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]></span><a href="#_背景知识"><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>背景知识</span></b></span><span
style='mso-bookmark:_Toc16587483'></span></a><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span lang=EN-US><o:p></o:p></span></b></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 21.0pt'><span style='mso-bookmark:_Toc16587483'><![if !supportLists]><span
lang=EN-US style='font-family:Wingdings'>&Oslash;<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]></span><a href="#_实验目的"><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>实验目的</span></b></span><span
style='mso-bookmark:_Toc16587483'></span></a><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span lang=EN-US><o:p></o:p></span></b></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 21.0pt'><span style='mso-bookmark:_Toc16587483'><![if !supportLists]><span
lang=EN-US style='font-family:Wingdings'>&Oslash;<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]></span><a href="#_工具/准备工作"><span style='mso-bookmark:
_Toc16587483'><b style='mso-bidi-font-weight:normal'><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>工具</span><span
lang=EN-US>/</span></b></span><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>准备工作</span></b></span><span
style='mso-bookmark:_Toc16587483'></span></a><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span lang=EN-US><o:p></o:p></span></b></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 21.0pt'><span style='mso-bookmark:_Toc16587483'><![if !supportLists]><span
lang=EN-US style='font-family:Wingdings'>&Oslash;<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]></span><a href="#_实验内容与步骤"><span style='mso-bookmark:
_Toc16587483'><b style='mso-bidi-font-weight:normal'><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>实验内容与步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'></span></a><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span lang=EN-US><o:p></o:p></span></b></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>&nbsp;</span></span></p>

<h3><span style='mso-bookmark:_Toc16587483'><a name="_Toc45702462"></a><a
name="_Toc39769785"></a><a name="_背景知识"></a><span style='mso-bookmark:_Toc45702462'><span
style='mso-bookmark:_Toc39769785'><span style='mso-bidi-font-family:宋体'>背景知识</span></span></span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='mso-bidi-font-family:
宋体'><o:p></o:p></span></span></h3>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>&nbsp;</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'></span><a
href="#_1._创建进程"><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>1. </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>创建进程</span></span><span
style='mso-bookmark:_Toc16587483'></span></a><span style='mso-bookmark:_Toc16587483'></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'></span><a
href="#_2._正在运行的进程"><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>2.
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>正在运行的进程</span></span><span
style='mso-bookmark:_Toc16587483'></span></a><span style='mso-bookmark:_Toc16587483'></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'></span><a
href="#_3._终止进程"><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>3. </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>终止进程</span></span><span
style='mso-bookmark:_Toc16587483'></span></a><span style='mso-bookmark:_Toc16587483'></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>&nbsp;</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>Windows</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所创建的每个进程都从调用</span><span lang=EN-US>CreateProcess() API</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数开始，该函数的任务是在对象管理器子系统内初始化进程对象。每一进程都以调用</span><span
lang=EN-US>ExitProcess() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>或</span><span lang=EN-US>TerminateProcess() API</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数终止。通常应用程序的框架负责调用</span><span
lang=EN-US> ExitProcess() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数。对于</span><span lang=EN-US>C++ </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>运行库来说，这一调用发生在应用程序的</span><span
lang=EN-US>main() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数返回之后。</span></span></p>

<h4><span style='mso-bookmark:_Toc16587483'><a name="_1._创建进程"></a><span
lang=EN-US style='mso-bidi-font-family:宋体'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp; </span>1. 创建进程<o:p></o:p></span></span></h4>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>CreateProcess() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>调用的核心参数是可执行文件运行时的文件名及其命令行。表</span><span lang=EN-US> 3-4</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>详细地列出了每个参数的类型和名称。</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>&nbsp;</span></span></p>

<p class=a><span style='mso-bookmark:_Toc16587483'>表<span lang=EN-US>3-4
CreateProcess() 函数的参数<o:p></o:p></span></span></p>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 width=510 style='width:382.5pt;
 margin-left:6.2pt;border-collapse:collapse;border:none;mso-border-top-alt:
 solid windowtext 1.5pt;mso-border-bottom-alt:solid windowtext 1.5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='height:17.0pt;mso-yfti-irow:0'>
  <td width=173 style='width:129.7pt;border-top:solid windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
  黑体'>参数名称<span lang=EN-US><o:p></o:p></span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
  <td width=337 style='width:252.8pt;border-top:solid windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext .5pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
  黑体'>使用目的<span lang=EN-US><o:p></o:p></span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
 </tr>
 <tr style='height:17.0pt;mso-yfti-irow:1'>
  <td width=173 style='width:129.7pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
  style='font-size:9.0pt'>LPCTSTR lpApplivationName<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
  <td width=337 style='width:252.8pt;border:none;border-bottom:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>全部或部分地指明包括可执行代码的</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>EXE</span></span><span
  style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
  宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件的文件名</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
 </tr>
 <tr style='height:17.0pt;mso-yfti-irow:2'>
  <td width=173 style='width:129.7pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
  style='font-size:9.0pt'>LPCTSTR lpCommandLine<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
  <td width=337 style='width:252.8pt;border:none;border-bottom:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>向可执行文件发送的参数</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
 </tr>
 <tr style='height:17.0pt;mso-yfti-irow:3'>
  <td width=173 style='width:129.7pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
  style='font-size:9.0pt'>LPSECURIITY_ATTRIBUTES lpProcessAttributes<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
  <td width=337 style='width:252.8pt;border:none;border-bottom:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>返回进程句柄的安全属性。主要指明这一句柄是否应该由其他子进程所继承</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
 </tr>
 <tr style='height:17.0pt;mso-yfti-irow:4'>
  <td width=173 style='width:129.7pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
  style='font-size:9.0pt'>LPSECURIITY_ATTRIBUTES lpThreadAttributes<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
  <td width=337 style='width:252.8pt;border:none;border-bottom:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>返回进程的主线程的句柄的安全属性</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
 </tr>
 <tr style='height:17.0pt;mso-yfti-irow:5'>
  <td width=173 style='width:129.7pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
  style='font-size:9.0pt'>BOOL bInheritHandle<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
  <td width=337 style='width:252.8pt;border:none;border-bottom:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>一种标志，告诉系统允许新进程继承创建者进程的句柄</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
 </tr>
 <tr style='height:17.0pt;mso-yfti-irow:6'>
  <td width=173 style='width:129.7pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
  style='font-size:9.0pt'>DWORD dwCreationFlage<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
  <td width=337 style='width:252.8pt;border:none;border-bottom:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>特殊的创建标志</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'> (</span></span><span
  style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
  宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>如</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>CREATE_SUSPENDED)
  </span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
  9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>的位标记</span></span><span style='mso-bookmark:_Toc16587483'><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
 </tr>
 <tr style='height:17.0pt;mso-yfti-irow:7'>
  <td width=173 style='width:129.7pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
  style='font-size:9.0pt'>LPVOID lpEnvironment<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
  <td width=337 style='width:252.8pt;border:none;border-bottom:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>向新进程发送的一套环境变量；如为</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>null</span></span><span
  style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
  宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>值则发送调用者环境</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
 </tr>
 <tr style='height:17.0pt;mso-yfti-irow:8'>
  <td width=173 style='width:129.7pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
  style='font-size:9.0pt'>LPCTSTR lpCurrentDirectory<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
  <td width=337 style='width:252.8pt;border:none;border-bottom:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>新进程的启动目录</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
 </tr>
 <tr style='height:17.0pt;mso-yfti-irow:9'>
  <td width=173 style='width:129.7pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
  style='font-size:9.0pt'>STARTUPINFO lpStartupInfo<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
  <td width=337 style='width:252.8pt;border:none;border-bottom:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
  style='font-size:9.0pt'>STARTUPINFO</span></span><span style='mso-bookmark:
  _Toc16587483'><span style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>结构，包括新进程的输入和输出配置的详情</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
 </tr>
 <tr style='height:17.0pt;mso-yfti-irow:10;mso-yfti-lastrow:yes'>
  <td width=173 style='width:129.7pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
  style='font-size:9.0pt'>LPPROCESS_INFORMATION lpProcessInformation<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
  <td width=337 style='width:252.8pt;border:none;border-bottom:solid windowtext 1.5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>调用的结果块；发送新应用程序的进程和主线程的句柄和</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>ID<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
 </tr>
</table>

</div>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>&nbsp;</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>可以指定第一个参数，即应用程序的名称，其中包括相对于当前进程的当前目录的全路径或者利用搜索方法找到的路径；</span><span
lang=EN-US>lpCommandLine</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>参数允许调用者向新应用程序发送数据；接下来的三个参数与进程和它的主线程以及返回的指向该对象的句柄的安全性有关。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>然后是标志参数，用以在</span><span lang=EN-US>dwCreationFlags</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>参数中指明系统应该给予新进程什么行为。经常使用的标志是</span><span
lang=EN-US>CREATE_SUSPNDED</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，告诉主线程立刻暂停。当准备好时，应该使用</span><span lang=EN-US>ResumeThread()
API</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>来启动进程。另一个常用的标志是</span><span lang=EN-US>CREATE_NEW_CONSOLE</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，告诉新进程启动自己的控制台窗口，而不是利用父窗口。这一参数还允许设置进程的优先级，用以向系统指明，相对于系统中所有其他的活动进程来说，给此进程多少</span><span
lang=EN-US>CPU</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>时间。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>接着是</span><span lang=EN-US>CreateProcess() </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数调用所需要的三个通常使用缺省值的参数。第一个参数是</span><span
lang=EN-US>lpEnvironment</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>参数，指明为新进程提供的环境；第二个参数是</span><span lang=EN-US>lpCurrentDirectory</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，可用于向主创进程发送与缺省目录不同的新进程使用的特殊的当前目录；第三个参数是</span><span
lang=EN-US>STARTUPINFO</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据结构所必需的，用于在必要时指明新应用程序的主窗口的外观。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>CreateProcess() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的最后一个参数是用于新进程对象及其主线程的句柄和</span><span lang=EN-US>ID</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的返回值缓冲区。以</span><span
lang=EN-US>PROCESS_INFORMATION</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>结构中返回的句柄调用</span><span lang=EN-US>CloseHandle() API</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数是重要的，因为如果不将这些句柄关闭的话，有可能危及主创进程终止之前的任何未释放的资源。</span></span></p>

<h4><span style='mso-bookmark:_Toc16587483'><a name="_2._正在运行的进程"></a><span
lang=EN-US style='mso-bidi-font-family:宋体'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp; </span>2. 正在运行的进程<o:p></o:p></span></span></h4>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>如果一个进程拥有至少一个执行线程，则为正在系统中运行的进程。通常，这种进程使用主线程来指示它的存在。当主线程结束时，调用</span><span
lang=EN-US>ExitProcess() API</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数，通知系统终止它所拥有的所有正在运行、准备运行或正在挂起的其他线程。当进程正在运行时，可以查看它的许多特性，其中少数特性也允许加以修改。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>首先可查看的进程特性是系统进程标识符</span><span lang=EN-US> (PID) </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，可利用</span><span
lang=EN-US>GetCurrentProcessId() API</span></span><span style='mso-bookmark:
_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>函数来查看，与</span><span lang=EN-US>GetCurrentProcess()
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>相似，对该函数的调用不能失败，但返回的</span><span
lang=EN-US>PID</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在整个系统中都可使用。其他的可显示当前进程信息的</span><span lang=EN-US>API</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数还有</span><span
lang=EN-US>GetStartupInfo()</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和</span><span lang=EN-US>GetProcessShutdownParameters() </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，可给出进程存活期内的配置详情。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>通常，一个进程需要它的运行期环境的信息。例如</span><span lang=EN-US>API</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数</span><span
lang=EN-US>GetModuleFileName() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和</span><span lang=EN-US>GetCommandLine() </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，可以给出用在</span><span
lang=EN-US>CreateProcess() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中的参数以启动应用程序。在创建应用程序时可使用的另一个</span><span lang=EN-US>API</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数是</span><span
lang=EN-US>IsDebuggerPresent() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>可利用</span><span lang=EN-US>API</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数</span><span
lang=EN-US>GetGuiResources() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>来查看进程的</span><span lang=EN-US>GUI</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>资源。此函数既可返回指定进程中的打开的</span><span
lang=EN-US>GUI</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>对象的数目，也可返回指定进程中打开的</span><span lang=EN-US>USER</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>对象的数目。进程的其他性能信息可通过</span><span
lang=EN-US>GetProcessIoCounters()</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、</span><span lang=EN-US>GetProcessPriorityBoost() </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>、</span><span
lang=EN-US>GetProcessTimes() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和</span><span lang=EN-US>GetProcessWorkingSetSize() API</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>得到。以上这几个</span><span
lang=EN-US>API</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数都只需要具有</span><span lang=EN-US>PROCESS_QUERY_INFORMATION</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>访问权限的指向所感兴趣进程的句柄。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>另一个可用于进程信息查询的</span><span lang=EN-US>API</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数是</span><span
lang=EN-US>GetProcessVersion() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。此函数只需感兴趣进程的</span><span lang=EN-US>PID (</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>进程标识号</span><span
lang=EN-US>) </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。本实验程序清单</span><span lang=EN-US>3-6</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中列出了这一</span><span
lang=EN-US>API</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数与</span><span lang=EN-US>GetVersionEx() </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的共同作用，可确定运行进程的系统的版本号。</span></span></p>

<h4><span style='mso-bookmark:_Toc16587483'><a name="_3._终止进程"></a><span
lang=EN-US style='mso-bidi-font-family:宋体'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp; </span>3. 终止进程<o:p></o:p></span></span></h4>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所有进程都是以调用</span><span lang=EN-US>ExitProcess() </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>或者</span><span
lang=EN-US>TerminateProcess() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数结束的。但最好使用前者而不要使用后者，因为进程是在完成了它的所有的关闭“职责”之后以正常的终止方式来调用前者的。而外部进程通常调用后者即突然终止进程的进行，由于关闭时的途径不太正常，有可能引起错误的行为。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>TerminateProcess() API</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数只要打开带有</span><span lang=EN-US>PROCESS_TERMINATE</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>访问权的进程对象，就可以终止进程，并向系统返回指定的代码。这是一种“野蛮”的终止进程的方式，但是有时却是需要的。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>如果开发人员确实有机会来设计“谋杀”</span><span lang=EN-US>(</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>终止别的进程的进程</span><span
lang=EN-US>) </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和“受害”进程</span><span lang=EN-US> (</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>被终止的进程</span><span
lang=EN-US>) </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>时，应该创建一个进程间通讯的内核对象――如一个互斥程序――这样一来，“受害”进程只在等待或周期性地测试它是否应该终止。</span></span><a
href="#_top"><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='text-decoration:none;text-underline:none'><!--[if gte vml 1]><v:shape
 id="_x0000_i1025" type="#_x0000_t75" style='width:45pt;height:17.25pt'>
 <v:imagedata src="./3-3.files/image003.gif" o:title="02"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=60 height=23
src="./3-3.files/image003.gif" v:shapes="_x0000_i1025"><![endif]></span></span><span
style='mso-bookmark:_Toc16587483'></span></a><span style='mso-bookmark:_Toc16587483'></span></p>

<h3><span style='mso-bookmark:_Toc16587483'><a name="_Toc45702463"></a><a
name="_Toc39769786"></a><a name="_实验目的"></a><span style='mso-bookmark:_Toc45702463'><span
style='mso-bookmark:_Toc39769786'><span style='mso-bidi-font-family:宋体'>实验目的</span></span></span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='mso-bidi-font-family:
宋体'><o:p></o:p></span></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>1) </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>通过创建进程、观察正在运行的进程和终止进程的程序设计和调试操作，进一步熟悉操作系统的进程概念，理解</span><span
lang=EN-US>Windows 2000</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>进程的“一生”。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>2) </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>通过阅读和分析实验程序，学习创建进程、观察进程和终止进程的程序设计方法。</span></span><a
href="#_top"><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='text-decoration:none;text-underline:none'><!--[if gte vml 1]><v:shape
 id="_x0000_i1026" type="#_x0000_t75" style='width:45pt;height:17.25pt'>
 <v:imagedata src="./3-3.files/image003.gif" o:title="02"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=60 height=23
src="./3-3.files/image003.gif" v:shapes="_x0000_i1026"><![endif]></span></span><span
style='mso-bookmark:_Toc16587483'></span></a><span style='mso-bookmark:_Toc16587483'></span></p>

<h3><span style='mso-bookmark:_Toc16587483'><a name="_Toc45702464"></a><a
name="_Toc39769787"></a><a name="_工具/准备工作"></a><span style='mso-bookmark:_Toc45702464'><span
style='mso-bookmark:_Toc39769787'><span style='mso-bidi-font-family:宋体'>工具<span
lang=EN-US>/准备工作</span></span></span></span></span><span style='mso-bookmark:
_Toc16587483'><span lang=EN-US style='mso-bidi-font-family:宋体'><o:p></o:p></span></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在开始本实验之前，请回顾教科书的相关内容。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>需要做以下准备：</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>1) </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>一台运行</span><span lang=EN-US>Windows 2000 Professional</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>操作系统的计算机。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>2) </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>计算机中需安装</span><span lang=EN-US>Visual C++ 6.0</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>专业版或企业版。</span></span><a
href="#_top"><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='text-decoration:none;text-underline:none'><!--[if gte vml 1]><v:shape
 id="_x0000_i1027" type="#_x0000_t75" style='width:45pt;height:17.25pt'>
 <v:imagedata src="./3-3.files/image003.gif" o:title="02"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=60 height=23
src="./3-3.files/image003.gif" v:shapes="_x0000_i1027"><![endif]></span></span><span
style='mso-bookmark:_Toc16587483'></span></a><span style='mso-bookmark:_Toc16587483'></span></p>

<h3><span style='mso-bookmark:_Toc16587483'><a name="_Toc45702465"></a><a
name="_Toc39769788"></a><a name="_实验内容与步骤"></a><span style='mso-bookmark:_Toc45702465'><span
style='mso-bookmark:_Toc39769788'><span style='mso-bidi-font-family:宋体'>实验内容与步骤</span></span></span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='mso-bidi-font-family:
宋体'><o:p></o:p></span></span></h3>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>&nbsp;</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'></span><a
href="#_1._创建进程_1"><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>1. </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>创建进程</span></span><span
style='mso-bookmark:_Toc16587483'></span></a><span style='mso-bookmark:_Toc16587483'></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'></span><a
href="#_2._正在运行的进程_1"><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>2.
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>正在运行的进程</span></span><span
style='mso-bookmark:_Toc16587483'></span></a><span style='mso-bookmark:_Toc16587483'></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'></span><a
href="#_3._终止进程"><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>3. </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>终止进程</span></span><span
style='mso-bookmark:_Toc16587483'></span></a><span style='mso-bookmark:_Toc16587483'></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>&nbsp;</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>请回答：</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>Windows</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所创建的每个进程都是以调用</span><span lang=EN-US>_____________________________
API</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数开始和以调用</span><span lang=EN-US>____________________________
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>或</span><span
lang=EN-US> _______________________ API</span></span><span style='mso-bookmark:
_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>函数终止。</span></span></p>

<h4><span style='mso-bookmark:_Toc16587483'><a name="_1._创建进程_1"></a><span
lang=EN-US style='mso-bidi-font-family:宋体'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp; </span>1. 创建进程<o:p></o:p></span></span></h4>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>本实验显示了创建子进程的基本框架。该程序只是再一次地启动自身，显示它的系统进程</span><span
lang=EN-US>ID</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和它在进程列表中的位置。</span></span></p>

<p class=MsoNormal style='text-indent:21.1pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.55pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>1</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：登录进入</span><span
lang=EN-US>Windows 2000 Professional</span></span><span style='mso-bookmark:
_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>2</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：在“开始”菜单中单击“程序”</span><span
lang=EN-US>-</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>“</span><span lang=EN-US>Microsoft Visual Studio 6.0</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>”</span><span
lang=EN-US>�C</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>“</span><span lang=EN-US>Microsoft Visual C++ 6.0</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>”命令，进入</span><span
lang=EN-US>Visual C++</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>窗口。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>3</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
style='font-family:楷体_utf-8;mso-ascii-font-family:"Times New Roman"'>：</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在工具栏单击“打开”按钮，在“打开”对话框中找到并打开实验源程序</span><span
lang=EN-US>3-5.cpp</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt;font-family:黑体'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp; </span>清单3-5<span style="mso-spacerun: yes">&nbsp;
</span>创建子进程<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// proccreate</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>项目</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span># include &lt;windows.h&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span># include &lt;iostream&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span># include &lt;stdio.h&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>创建传递过来的进程的克隆过程并赋于其</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>ID</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>值</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>void StartClone(int nCloneID)<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>提取用于当前可执行文件的文件名</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>TCHAR
szFilename[MAX_PATH] ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>:: GetModuleFileName(NULL,
szFilename, MAX_PATH) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>格式化用于子进程的命令行并通知其</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>EXE</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件名和克隆</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>ID<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>TCHAR
szCmdLine[MAX_PATH] ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>:: sprintf(szCmdLine,
“\”%s\” %d”, szFilename, nCloneID) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用于子进程的</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>STARTUPINFO</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>结构</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>STARTUPINFO si;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:
yes">&nbsp;</span>:: ZeroMemory(reinterpret_cast &lt;void*&gt; (&amp;si) ,
sizeof(si) ) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>si.cb = sizeof(si) ;<span
style='mso-tab-count:5'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>必须是本结构的大小</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>返回的用于子进程的进程信息</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PROCESS_INFORMATION pi;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>利用同样的可执行文件和命令行创建进程，并赋于其子进程的性质</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>BOOL bCreateOK = ::
CreateProcess(<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>szFilename,<span
style='mso-tab-count:5'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>产生这个</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'>EXE</span></span><span style='mso-bookmark:
_Toc16587483'><span style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的应用程序的名称</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>szCmdLine,<span style='mso-tab-count:5'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>告诉其行为像一个子进程的标志</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NULL,<span
style='mso-tab-count:6'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>缺省的进程安全性</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>NULL,<span style='mso-tab-count:6'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>缺省的线程安全性</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>FALSE,<span style='mso-tab-count:6'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>不继承句柄</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>CREATE_NEW_CONSOLE,<span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>使用新的控制台</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NULL,<span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>新的环境</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>NULL,<span style='mso-tab-count:6'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>当前目录</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>&amp;si,<span style='mso-tab-count:6'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>启动信息</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&amp;pi)
;<span style='mso-tab-count:6'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>返回的进程信息</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>对子进程释放引用</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (bCreateOK)<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>:: CloseHandle(pi.hProcess) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>:: CloseHandle(pi.hThread) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>int main(int argc, char* argv[] )<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>确定进程在列表中的位置</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>int
nClone(0) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (argc
&gt; 1)<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>// </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>从第二个参数中提取克隆</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>ID<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>:: sscanf(argv[1] , “%d” , &amp;nClone) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>显示进程位置</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>std :: cout
&lt;&lt; “Process ID: “ &lt;&lt; :: GetCurrentProcessId()<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>&lt;&lt; “, Clone ID: “ &lt;&lt; nClone<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>&lt;&lt; std :: endl;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>检查是否有创建子进程的需要</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>const int
c_nCloneMax = 25;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (nClone
&lt; C_nCloneMax)<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>// </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>发送新进程的命令行和克隆号</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>StartClone(++nClone) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:27.0pt;mso-char-indent-count:3.0;
mso-char-indent-size:9.0pt;mso-char-indent-size:9pt'><span style='mso-bookmark:
_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><span
style="mso-spacerun: yes">&nbsp;</span><span style="mso-spacerun:
yes">&nbsp;&nbsp; </span>// </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在终止之前暂停一下</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>
(l/2</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>秒</span></span><span style='mso-bookmark:
_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>)<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>::
Sleep(500) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:18.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:9.0pt;mso-char-indent-size:9pt'><span style='mso-bookmark:
_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><span
style="mso-spacerun: yes">&nbsp;</span><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>return 0;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>4</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
style='font-family:楷体_utf-8;mso-ascii-font-family:"Times New Roman"'>：</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>单击“</span><span
lang=EN-US>Build</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”菜单中的“</span><span lang=EN-US>Compile 3-5.cpp</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>”命令，系统显示：</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>This
build command requires an active project workspace. Would you like to <br>
<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>create a default
project workspace ?<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt;mso-char-indent-count:
-2.0;mso-char-indent-size:10.5pt;mso-char-indent-size:10.5pt'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(build</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>命令需要一个活动的项目工作空间。你是否希望建立一个缺省的</span><span
lang=EN-US><br>
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>项目工作空间？</span><span
lang=EN-US>)</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>单击“是”按钮确认。系统对</span><span lang=EN-US>3-5.cpp</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>进行编译。</span></span></p>

<p class=MsoNormal style='text-indent:21.1pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.55pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>5</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
style='font-family:楷体_utf-8;mso-ascii-font-family:"Times New Roman"'>：</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>编译完成后，单击“</span><span
lang=EN-US>Build</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”菜单中的“</span><span lang=EN-US>Build 3-5.exe</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>”命令，建立</span><span
lang=EN-US>3-5.exe</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>可执行文件。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>操作能否正常进行？如果不行，则可能的原因是什么？</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>____________________________________________________________________</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>________________________________________________________________________</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>6</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
style='font-family:楷体_utf-8;mso-ascii-font-family:"Times New Roman"'>：</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在工具栏单击“</span><span
lang=EN-US>Execute Program</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”</span><span lang=EN-US>(</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>执行程序</span><span
lang=EN-US>) </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>按钮，或者按</span><span lang=EN-US>Ctrl + F5</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>键，或者单击“</span><span
lang=EN-US>Build</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”菜单中的“</span><span lang=EN-US>Execute 3-5.exe</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>”命令，执行</span><span
lang=EN-US>3-5.exe</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>程序。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>7</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
style='font-family:楷体_utf-8;mso-ascii-font-family:"Times New Roman"'>：</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>按</span><span
lang=EN-US>Ctrl + S</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>键可暂停程序的执行，按</span><span lang=EN-US>Ctrl + Pause (Break) </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>键可终止程序的执行。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>清单</span><span lang=EN-US>3-5</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>展示的是一个简单的使用</span><span
lang=EN-US>CreateProcess() API</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数的例子。首先形成简单的命令行，提供当前的</span><span lang=EN-US>EXE</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件的指定文件名和代表生成克隆进程的号码。大多数参数都可取缺省值，但是创建标志参数使用了：</span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US>________________________________________________________________________</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>标志，指示新进程分配它自己的控制台，这使得运行示例程序时，在任务栏上产生许多活动标记。然后该克隆进程的创建方法关闭传递过来的句柄并返回</span><span
lang=EN-US>main() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数。在关闭程序之前，每一进程的执行主线程暂停一下，以便让用户看到其中的至少一个窗口。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>CreateProcess() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数有</span><span lang=EN-US>________</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>个核心参数？本实验程序中设置的各个参数的值是：</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>a. _________________________________________________</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>；</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>b. _________________________________________________</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>；</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>c. _________________________________________________</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>；</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>d. _________________________________________________</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>；</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>e. _________________________________________________</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>；</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>f. _________________________________________________</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>；</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>g. _________________________________________________</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>；</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>h. _________________________________________________</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>程序运行时屏幕显示的信息是：</span></span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:21.0pt'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US>____________________________________________________________________</span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US>________________________________________________________________________</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>&nbsp;<o:p></o:p></span></span></p>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 style='margin-left:5.35pt;
 border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='height:38.0pt;mso-yfti-irow:0;mso-yfti-lastrow:yes'>
  <td width=510 style='width:382.6pt;border:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:38.0pt'>
  <p class=MsoNormal style='margin-left:.25pt;text-indent:-.25pt;mso-char-indent-count:
  -.03;mso-char-indent-size:8.3pt;mso-char-indent-size:8.3pt'><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><span
  style="mso-spacerun: yes">&nbsp;</span><span style="mso-spacerun:
  yes">&nbsp;&nbsp; </span></span></span><span style='mso-bookmark:_Toc16587483'><b><span
  style='font-size:9.0pt;font-family:黑体;color:red'>提示</span></b></span><span
  style='mso-bookmark:_Toc16587483'><b><span style='font-size:9.0pt;font-family:
  宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
  color:red'>：</span></b></span><span style='mso-bookmark:_Toc16587483'><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>部分程序在</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>Visual
  C++</span></span><span style='mso-bookmark:_Toc16587483'><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>环境完成编译、链接之后，还可以在</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>Windows
  2000</span></span><span style='mso-bookmark:_Toc16587483'><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>的“命令提示符”状态下尝试执行该程序，看看与在可视化界面下运行的结果有没有不同？为什么？</span></span><span
  style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc16587483'></span>
 </tr>
</table>

</div>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>&nbsp;</span></span></p>

<h4><span style='mso-bookmark:_Toc16587483'><a name="_2._正在运行的进程_1"></a><span
lang=EN-US style='mso-bidi-font-family:宋体'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp; </span>2. 正在运行的进程<o:p></o:p></span></span></h4>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>本实验的程序中列出了用于进程信息查询的</span><span lang=EN-US>API</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数</span><span
lang=EN-US>GetProcessVersion() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>与</span><span lang=EN-US>GetVersionEx() </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的共同作用，可确定运行进程的操作系统的版本号。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>8</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：在</span><span
lang=EN-US>Visual C++ </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>窗口的工具栏中单击“打开”按钮，在“打开”对话框中找到并打开实验源程序</span><span lang=EN-US>3-6.cpp</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt;font-family:黑体'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp; </span>清单3-6<span style="mso-spacerun: yes">&nbsp;
</span>使用进程和操作系统的版本信息<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// version</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>项目</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span># include &lt;windows.h&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span># include &lt;iostream&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>利用进程和操作系统的版本信息的简单示例</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>void main()<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>提取这个进程的</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>ID</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>号</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DWORD
dwIdThis = :: GetCurrentProcessId() ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>获得这一进程和报告所需的版本，也可以发送</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>0</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>以便指明这一进程</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DWORD
dwVerReq = :: GetProcessVersion(dwIdThis) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>WORD
wMajorReq = (WORD) dwVerReq &gt; 16) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>WORD
wMinorReq = (WORD) dwVerReq &amp; 0xffff) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>std :: cout
&lt;&lt; “Process ID: “ &lt;&lt; dwIdThis<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>&lt;&lt; “, requires OS: “ &lt;&lt; wMajorReq &lt;&lt; wMinorReq
&lt;&lt; std&nbsp;:: endl&nbsp;;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>设置版本信息的数据结构，以便保存操作系统的版本信息</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>OSVERSIONINFOEX
osvix;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>::
ZeroMemory(&amp;osvix, sizeof(osvix) ) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>osvix.dwOSVersionInfoSize = sizeof(osvix) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>提取版本信息和报告</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>::
GetVersionEx(reinterpret_cast &lt; LPOSVERSIONINFO &gt; (&amp;osvix) ) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>std :: cout
&lt;&lt; “Running on OS: “ &lt;&lt; osvix.dwMajorVersion &lt;&lt; “.”<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>&lt;&lt; osvix.dwMinorVersion &lt;&lt; std :: endl;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>如果是</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>NTS
(Windows 2000) </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>系统，则提高其优先权</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if
(osvix.dwPlatformld = = VER_PLATFORM_WIN32_NT &amp;&amp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>osvix.dwMajorVersion &gt;= 5)<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>// </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>改变优先级</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>:: SetPriorityClass(<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>:: GetCurrentProcess() ,<span style='mso-tab-count:5'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>利用这一进程</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>HIGH_PRIORITY_CLASS) ;<span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>改变为</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'>high<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>// </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>报告给用户</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>std :: cout &lt;&lt; “Task Manager should now now indicate this”<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>“process is high priority</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>．</span></span><span style='mso-bookmark:
_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>” &lt;&lt; std :: endl;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>9</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
style='font-family:楷体_utf-8;mso-ascii-font-family:"Times New Roman"'>：</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>单击“</span><span
lang=EN-US>Build</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”菜单中的“</span><span lang=EN-US>Compile 3-6.cpp</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>”命令，再单击“是”按钮确认。系统对</span><span
lang=EN-US>3-6.cpp</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>进行编译。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>10</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
style='font-family:楷体_utf-8;mso-ascii-font-family:"Times New Roman"'>：</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>编译完成后，单击“</span><span
lang=EN-US>Build</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”菜单中的“</span><span lang=EN-US>Build 3-6.exe</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>”命令，建立</span><span
lang=EN-US>3-6.exe</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>可执行文件。</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>操作能否正常进行？如果不行，则可能的原因是什么？</span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp; </span>____________________________________________________________________</span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US>________________________________________________________________________</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>11</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
style='font-family:楷体_utf-8;mso-ascii-font-family:"Times New Roman"'>：</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在工具栏单击“</span><span
lang=EN-US>Execute Program</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”</span><span lang=EN-US> (</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>执行程序</span><span
lang=EN-US>) </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>按钮，执行</span><span lang=EN-US>3-6.exe</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>程序。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>运行结果：</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>当前</span><span lang=EN-US>PID</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>信息：</span><span
lang=EN-US>______________________________________________________</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>当前操作系统版本：</span><span lang=EN-US>__________________________________________________</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>系统提示信息：</span><span lang=EN-US>______________________________________________________</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US>_______________________________________________________________________</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>清单</span><span lang=EN-US>3-6</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中的程序向读者表明了如何获得当前的</span><span
lang=EN-US>PID</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和所需的进程版本信息。为了运行这一程序，系统处理了所有的版本不兼容问题。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>接着，程序演示了如何使用</span><span lang=EN-US>GetVersionEx() API</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数来提取</span><span
lang=EN-US>OSVERSIONINFOEX</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>结构。这一数据块中包括了操作系统的版本信息。其中，“</span><span lang=EN-US>OS : 5.0</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>”表示当前运行的操作系统是：</span></span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:21.0pt'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US>____________________________________________________________________</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>清单</span><span lang=EN-US>3-6</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的最后一段程序利用了操作系统的版本信息，以确认运行的是</span><span
lang=EN-US>Windows 2000</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。代码接着将当前进程的优先级提高到比正常级别高。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>12</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
style='font-family:楷体_utf-8;mso-ascii-font-family:"Times New Roman"'>：</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>单击</span><span
lang=EN-US>Ctrl + Alt + Del</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>键，进入“</span><span lang=EN-US>Windows</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>任务管理器”，在“应用程序”选项卡中右键单击“</span><span
lang=EN-US>3-6</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”任务，在快捷菜单中选择“转到进程”命令。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在“</span><span lang=EN-US>Windows</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>任务管理器”的“进程”选项卡中，与“</span><span
lang=EN-US>3-6</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”任务对应的进程映像名称是</span><span lang=EN-US> (</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>为什么？</span><span
lang=EN-US>) </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>：</span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US>____________________________________________________________________</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>右键单击该进程名，在快捷菜单中选择“设置优先级”命令，可以调整该进程的优先级，如设置为“高”后重新运行</span><span
lang=EN-US>3-6.exe</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>程序，屏幕显示有变化吗？为什么？</span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp; </span>____________________________________________________________________</span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US>________________________________________________________________________</span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US>________________________________________________________________________<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt;mso-char-indent-size:10.5pt'><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>除了改变进程的优先级以外，还可以对正在运行的进程执行几项其他的操作，只要获得其进程句柄即可。</span><span
lang=EN-US>SetProcessAffinityMask() API</span></span><span style='mso-bookmark:
_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>函数允许开发人员将线程映射到处理器上；</span><span
lang=EN-US>SetProcessPriorityBoost() API</span></span><span style='mso-bookmark:
_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>可关闭前台应用程序优先级的提升；而</span><span
lang=EN-US> SetProcessWorkingSet() API</span></span><span style='mso-bookmark:
_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>可调节进程可用的非页面</span><span lang=EN-US>RAM</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的容量；还有一个只对当前进程可用的</span><span
lang=EN-US>API</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数，即</span><span lang=EN-US>SetProcessShutdownParameters() </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，可告诉系统如何终止该进程。</span></span></p>

<h4><span style='mso-bookmark:_Toc16587483'><span lang=EN-US style='mso-bidi-font-family:
宋体'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>3. 终止进程<o:p></o:p></span></span></h4>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在清单</span><span lang=EN-US>3-7</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>列出的程序中，先创建一个子进程，然后指令它发出“自杀弹”互斥体去终止自身的运行。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>13</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：在</span><span
lang=EN-US>Visual C++ </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>窗口的工具栏中单击“打开”按钮，在“打开”对话框中找到并打开实验源程序</span><span lang=EN-US>3-7.cpp</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt;font-family:黑体'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp; </span>清单3-7<span style="mso-spacerun: yes">&nbsp;
</span>指令其子进程来“杀掉”自己的父进程<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// procterm</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>项目</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span># include &lt;windows.h&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span># include &lt;iostream&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span># include &lt;stdio.h&gt;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>static LPCTSTR g_szMutexName =
“w2kdg.ProcTerm.mutex.Suicide” ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>创建当前进程的克隆进程的简单方法</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>void StartClone()<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>提取当前可执行文件的文件名</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>TCHAR
szFilename [MAX_PATH] ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>::
GetModuleFileName(NULL, szFilename, MAX_PATH) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>格式化用于子进程的命令行，指明它是一个</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>EXE</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件和子进程</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>TCHAR
szCmdLine[MAX_PATH] ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>::
sprintf(szCmdLine, “\” %s\ “ child” , szFilename) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>子进程的启动信息结构</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>STARTUPINFO
si;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>::
ZeroMemory(reinterpret_cast &lt; void* &gt; (&amp;si) , sizeof(si) ) ;<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:45.0pt;mso-char-indent-count:5.0;
mso-char-indent-size:9.0pt;mso-char-indent-size:9pt'><span style='mso-bookmark:
_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>si.cb = sizeof(si) ;<span
style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>应当是此结构的大小</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>返回的用于子进程的进程信息</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>PROCESS_INFORMATION pi;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用同样的可执行文件名和命令行创建进程，并指明它是一个子进程</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>BOOL
bCreateOK = :: CreateProcess(<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>szFilename,<span style='mso-tab-count:5'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>产生的应用程序名称</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'> (</span></span><span style='mso-bookmark:
_Toc16587483'><span style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>本</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>EXE</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>)<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>szCmdLine,<span style='mso-tab-count:5'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>告诉我们这是一个子进程的标志</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>NULL,<span style='mso-tab-count:6'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>用于进程的缺省的安全性</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>NULL,<span style='mso-tab-count:6'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>用于线程的缺省安全性</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>FALSE,<span style='mso-tab-count:6'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>不继承句柄</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>CREATE_NEW_CONSOLE,<span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>创建新窗口，使输出更直观</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>NULL,<span style='mso-tab-count:6'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>新环境</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>NULL,<span style='mso-tab-count:6'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>当前目录</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>&amp;si,<span style='mso-tab-count:7'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>启动信息结构</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>&amp;pi ) ;<span style='mso-tab-count:6'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>返回的进程信息</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:9.0pt;mso-char-indent-count:1.0;
mso-char-indent-size:9.0pt;mso-char-indent-size:9pt'><span style='mso-bookmark:
_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><span
style="mso-spacerun: yes">&nbsp;</span><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>释放指向子进程的引用</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if
(bCreateOK)<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>:: CloseHandle(pi.hProcess) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>:: CloseHandle(pi.hThread) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>void Parent()<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>创建“自杀”互斥程序体</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>HANDLE
hMutexSuicide = :: CreateMutex(<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>NULL,<span style='mso-tab-count:5'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>缺省的安全性</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>TRUE,<span style='mso-tab-count:5'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>最初拥有的</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>g_szMutexName) ;<span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>为其命名</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if
(hMutexSuicide != NULL)<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>// </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>创建子进程</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>std :: cout &lt;&lt; “Creating the child process.” &lt;&lt; std :: endl;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>:: StartClone() ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>// </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>暂停</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>:: sleep(5000) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>// </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>指令子进程“杀”掉自身</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:36.0pt;mso-char-indent-count:4.0;
mso-char-indent-size:9.0pt;mso-char-indent-size:9pt'><span style='mso-bookmark:
_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><span
style="mso-spacerun: yes">&nbsp;</span><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>std :: cout &lt;&lt; “Telling the child
process to quit. ” &lt;&lt; std :: endl;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>:: ReleaseMutex(hMutexSuicide) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>// </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>消除句柄</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>:: CloseHandle(hMutexSuicide) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:27.0pt;mso-char-indent-count:3.0;
mso-char-indent-size:9.0pt;mso-char-indent-size:9pt'><span style='mso-bookmark:
_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>}<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:27.0pt;mso-char-indent-count:3.0;
mso-char-indent-size:9.0pt;mso-char-indent-size:9pt'><span style='mso-bookmark:
_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>void Child()<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:27.0pt;mso-char-indent-count:3.0;
mso-char-indent-size:9.0pt;mso-char-indent-size:9pt'><span style='mso-bookmark:
_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>打开“自杀”互斥体</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>HANDLE
hMutexSuicide = :: OpenMutex(<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>SYNCHRONIZE,<span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>打开用于同步</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>FALSE,<span style='mso-tab-count:5'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>不需要向下传递</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>g_szMutexName) ;<span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>名称</span></span><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if
(hMutexSuicide != NULL)<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>// </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>报告正在等待指令</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>std :: cout &lt;&lt; “Child waiting for suicide instructions. ” &lt;&lt;
std :: endl;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>:: WaitForSingleObject(hMutexSuicide, INFINITE) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>// </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>准备好终止，清除句柄</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>std :: cout &lt;&lt; “Child quiting. ” &lt;&lt; std :: endl;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>:: CloseHandle(hMutexSuicide) ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'>&nbsp;<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:27.0pt;mso-char-indent-count:3.0;
mso-char-indent-size:9.0pt;mso-char-indent-size:9pt'><span style='mso-bookmark:
_Toc16587483'><span lang=EN-US style='font-size:9.0pt'>int main(int arqc, char*
argv[] )<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun: yes">&nbsp;&nbsp; </span><span
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>// </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>决定其行为是父进程还是子进程</span></span><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (argc
&gt; l &amp;&amp; :: strcmp(argv[l] , “child” ) = = 0)<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Child() ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Parent() ;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return 0;<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US
style='font-size:9.0pt'><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>清单</span><span lang=EN-US>3-7</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中的程序说明了一个进程从“生”到“死”的整个一生。第一次执行时，它创建一个子进程，其行为如同“父亲”。在创建子进程之前，先创建一个互斥的内核对象，其行为对于子进程来说，如同一个“自杀弹”。当创建子进程时，就打开了互斥体并在其他线程中进行别的处理工作，同时等待着父进程使用</span><span
lang=EN-US>ReleaseMutex() API</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>发出“死亡”信号。然后用</span><span lang=EN-US>Sleep() API</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>调用来模拟父进程处理其他工作，等完成时，指令子进程终止。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>当调用</span><span lang=EN-US>ExitProcess() </span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>时要小心，进程中的所有线程都被立刻通知停止。在设计应用程序时，必须让主线程在正常的</span><span
lang=EN-US>C++ </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>运行期关闭</span><span lang=EN-US> (</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>这是由编译器提供的缺省行为</span><span
lang=EN-US>) </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>之后来调用这一函数。当它转向受信状态时，通常可创建一个每个活动线程都可等待和停止的终止事件。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在正常的终止操作中，进程的每个工作线程都要终止，由主线程调用</span><span lang=EN-US>ExitProcess()</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。接着，管理层对进程增加的所有对象释放引用，并将用</span><span
lang=EN-US> GetExitCodeProcess() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>建立的退出代码从</span><span lang=EN-US>STILL_ACTIVE</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>改变为在</span><span
lang=EN-US>ExitProcess() </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>调用中返回的值。最后，主线程对象也如同进程对象一样转变为受信状态。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
mso-char-indent-size:10.5pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>等到所有打开的句柄都关闭之后，管理层的对象管理器才销毁进程对象本身。还没有一种函数可取得终止后的进程对象为其参数，从而使其“复活”。当进程对象引用一个终止了的对象时，有好几个</span><span
lang=EN-US>API</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数仍然是有用的。进程可使用退出代码将终止方式通知给调用</span><span lang=EN-US>GetExitCodeProcess()
</span></span><span style='mso-bookmark:_Toc16587483'><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的其他进程。同时，</span><span
lang=EN-US>GetProcessTimes() API</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数可向主调者显示进程的终止时间。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>14</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
style='font-family:楷体_utf-8;mso-ascii-font-family:"Times New Roman"'>：</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>单击“</span><span
lang=EN-US>Build</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”菜单中的“</span><span lang=EN-US>Compile 3-7.cpp</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>”命令，再单击“是”按钮确认。系统对</span><span
lang=EN-US>3-7.cpp</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>进行编译。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>15</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
style='font-family:楷体_utf-8;mso-ascii-font-family:"Times New Roman"'>：</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>编译完成后，单击“</span><span
lang=EN-US>Build</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”菜单中的“</span><span lang=EN-US>Build 3-7.exe</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>”命令，建立</span><span
lang=EN-US>3-7.exe</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>可执行文件。</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc16587483'><span lang=EN-US><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>操作能否正常进行？如果不行，则可能的原因是什么？</span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp; </span>____________________________________________________________________</span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US>________________________________________________________________________</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>16</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
style='font-family:楷体_utf-8;mso-ascii-font-family:"Times New Roman"'>：</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在工具栏单击“</span><span
lang=EN-US>Execute Program</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”按钮，执行</span><span lang=EN-US>3-7.exe</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>程序。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>运行结果：</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>1) __________________________________________________________________</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表示：</span><span lang=EN-US>______________________________________________________________</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
lang=EN-US>2)
__________________________________________________________________</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表示：</span><span lang=EN-US>______________________________________________________________</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bookmark:_Toc16587483'><b
style='mso-bidi-font-weight:normal'><span style='font-family:楷体_utf-8;
mso-ascii-font-family:"Times New Roman"'>步骤</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-fareast-font-family:楷体_utf-8'>17</span></b></span><span
style='mso-bookmark:_Toc16587483'><b style='mso-bidi-font-weight:normal'><span
style='font-family:楷体_utf-8;mso-ascii-font-family:"Times New Roman"'>：</span></b></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在熟悉清单</span><span
lang=EN-US>3-7</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>源代码的基础上，利用本实验介绍的</span><span lang=EN-US>API</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数来尝试改进本程序</span><span
lang=EN-US> (</span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>例如使用</span><span lang=EN-US>GetProcessTimes() API</span></span><span
style='mso-bookmark:_Toc16587483'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数</span><span
lang=EN-US>) </span></span><span style='mso-bookmark:_Toc16587483'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>并运行。请描述你所做的工作：</span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><span lang=EN-US><span style="mso-spacerun:
yes">&nbsp;&nbsp;&nbsp; </span>____________________________________________________________________</span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><a name="_Toc39769789"><span lang=EN-US>________________________________________________________________________</span></a></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><span style='mso-bookmark:_Toc39769789'><span
lang=EN-US>________________________________________________________________________</span></span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc16587483'><span style='mso-bookmark:_Toc39769789'><span
lang=EN-US>________________________________________________________________________</span></span></span></p>

<span style='mso-bookmark:_Toc39769789'></span><span style='mso-bookmark:_Toc16587483'></span>

<p class=MsoNormal><span lang=EN-US>&nbsp;<span style='color:blue'><a
href="#_top"><span style='text-decoration:none;text-underline:none'><!--[if gte vml 1]><v:shape
 id="_x0000_i1028" type="#_x0000_t75" style='width:45pt;height:17.25pt'>
 <v:imagedata src="./3-3.files/image003.gif" o:title="02"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=60 height=23
src="./3-3.files/image003.gif" v:shapes="_x0000_i1028"><![endif]></span></a></span>
<a href="Bookin.htm"><span style='text-decoration:none;text-underline:none'><!--[if gte vml 1]><v:shape
 id="_x0000_i1029" type="#_x0000_t75" style='width:17.25pt;height:17.25pt'>
 <v:imagedata src="./3-3.files/image004.gif" o:title="00"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=23 height=23
src="./3-3.files/image005.jpg" v:shapes="_x0000_i1029"><![endif]></span></a></span></p>

</div>

</body>

</html>
